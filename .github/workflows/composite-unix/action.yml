runs:

  using: "composite"

  steps:

  - name: Install Ninja (macOS)
    if: runner.os == 'macOS'
    shell: bash
    run: brew install ninja


  - name: install ninja (Linux)
    shell: bash
    if: runner.os == 'Linux'
    run: |
      sudo apt update
      sudo apt install --no-install-recommends ninja-build

  - run: cmake --workflow --preset debug
    shell: bash

  - run: cmake --workflow --preset release
    shell: bash

  - name: upload CMakeConfigureLog.yaml
    if: failure() && hashFiles('build/CMakeFiles/CMakeConfigureLog.yaml') != ''
    uses: actions/upload-artifact@v4
    with:
      name: ${{ runner.os }}-${{ env.CC }}-CMakeConfigureLog.yaml
      path: build/CMakeFiles/CMakeConfigureLog.yaml
